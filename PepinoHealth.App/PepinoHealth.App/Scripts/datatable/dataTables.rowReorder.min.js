/*!
 RowReorder 1.2.0
 2015-2016 SpryMedia Ltd - datatables.net/license
*/
(function(n){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(t){return n(t,window,document)}):"object"==typeof exports?module.exports=function(t,i){return t||(t=window),i&&i.fn.dataTable||(i=require("datatables.net")(t,i).$),n(i,t,t.document)}:n(jQuery,window,document)})(function(n,t,i,r){var f=n.fn.dataTable,u=function(t,i){if(!f.versionCheck||!f.versionCheck("1.10.8"))throw"DataTables RowReorder requires DataTables 1.10.8 or newer";this.c=n.extend(!0,{},f.defaults.rowReorder,u.defaults,i);this.s={bodyTop:null,dt:new f.Api(t),getDataFn:f.ext.oApi._fnGetObjectDataFn(this.c.dataSrc),middles:null,scroll:{},scrollInterval:null,setDataFn:f.ext.oApi._fnSetObjectDataFn(this.c.dataSrc),start:{top:0,left:0,offsetTop:0,offsetLeft:0,nodes:[]},windowHeight:0};this.dom={clone:null,dtScroll:n("div.dataTables_scrollBody",this.s.dt.table().container())};var r=this.s.dt.settings()[0],e=r.rowreorder;if(e)return e;r.rowreorder=this;this._constructor()},e;n.extend(u.prototype,{_constructor:function(){var i=this,t=this.s.dt,r=n(t.table().node());"static"===r.css("position")&&r.css("position","relative");n(t.table().container()).on("mousedown.rowReorder touchstart.rowReorder",this.c.selector,function(r){if(i.c.enabled){var u=n(this).closest("tr");if(t.row(u).any())return i._mouseDown(r,u),!1}});t.on("destroy.rowReorder",function(){n(t.table().container()).off(".rowReorder");t.off(".rowReorder")})},_cachePositions:function(){var i=this.s.dt,f=n(i.table().node()).find("thead").outerHeight(),u=n.unique(i.rows({page:"current"}).nodes().toArray()),r=n.map(u,function(t){return n(t).position().top-f}),u=n.map(r,function(t,u){return r.length<u-1?(t+r[u+1])/2:(t+t+n(i.row(":last-child").node()).outerHeight())/2});this.s.middles=u;this.s.bodyTop=n(i.table().body()).offset().top;this.s.windowHeight=n(t).height()},_clone:function(t){var i=n(this.s.dt.table().node().cloneNode(!1)).addClass("dt-rowReorder-float").append("<tbody/>").append(t.clone(!1)),r=t.outerWidth(),u=t.outerHeight(),f=t.children().map(function(){return n(this).width()});i.width(r).height(u).find("tr").children().each(function(n){this.style.width=f[n]+"px"});i.appendTo("body");this.dom.clone=i},_clonePosition:function(n){var t=this.s.start,r=this._eventToPage(n,"Y")-t.top,n=this._eventToPage(n,"X")-t.left,i=this.c.snapX;this.dom.clone.css({top:r+t.offsetTop,left:!0===i?t.offsetLeft:"number"==typeof i?t.offsetLeft+i:n+t.offsetLeft})},_emitEvent:function(t,i){this.s.dt.iterator("table",function(r){n(r.nTable).triggerHandler(t+".dt",i)})},_eventToPage:function(n,t){return-1!==n.type.indexOf("touch")?n.originalEvent.touches[0]["page"+t]:n["page"+t]},_mouseDown:function(r,u){var o=this,f=this.s.dt,e=this.s.start,s=u.offset();e.top=this._eventToPage(r,"Y");e.left=this._eventToPage(r,"X");e.offsetTop=s.top;e.offsetLeft=s.left;e.nodes=n.unique(f.rows({page:"current"}).nodes().toArray());this._cachePositions();this._clone(u);this._clonePosition(r);this.dom.target=u;u.addClass("dt-rowReorder-moving");n(i).on("mouseup.rowReorder touchend.rowReorder",function(n){o._mouseUp(n)}).on("mousemove.rowReorder touchmove.rowReorder",function(n){o._mouseMove(n)});n(t).width()===n(i).width()&&n(i.body).addClass("dt-rowReorder-noOverflow");f=this.dom.dtScroll;this.s.scroll={windowHeight:n(t).height(),windowWidth:n(t).width(),dtTop:f.length?f.offset().top:null,dtLeft:f.length?f.offset().left:null,dtHeight:f.length?f.outerHeight():null,dtWidth:f.length?f.outerWidth():null}},_mouseMove:function(t){this._clonePosition(t);for(var r=this._eventToPage(t,"Y")-this.s.bodyTop,f=this.s.middles,i=null,e=this.s.dt,o=e.table().body(),u=0,s=f.length;u<s;u++)if(r<f[u]){i=u;break}null===i&&(i=f.length);(null===this.s.lastInsert||this.s.lastInsert!==i)&&(0===i?this.dom.target.prependTo(o):(r=n.unique(e.rows({page:"current"}).nodes().toArray()),i>this.s.lastInsert?this.dom.target.insertAfter(r[i-1]):this.dom.target.insertBefore(r[i])),this._cachePositions(),this.s.lastInsert=i);this._shiftScroll(t)},_mouseUp:function(){var y=this,r=this.s.dt,t,s,h=this.c.dataSrc;this.dom.clone.remove();this.dom.clone=null;this.dom.target.removeClass("dt-rowReorder-moving");n(i).off(".rowReorder");n(i.body).removeClass("dt-rowReorder-noOverflow");clearInterval(this.s.scrollInterval);this.s.scrollInterval=null;var u=this.s.start.nodes,f=n.unique(r.rows({page:"current"}).nodes().toArray()),o={},e=[],c=[],l=this.s.getDataFn,p=this.s.setDataFn;for(t=0,s=u.length;t<s;t++)if(u[t]!==f[t]){var a=r.row(f[t]).id(),w=r.row(f[t]).data(),v=r.row(u[t]).data();a&&(o[a]=l(v));e.push({node:f[t],oldData:l(w),newData:l(v),newPosition:t,oldPosition:n.inArray(f[t],u)});c.push(f[t])}if(u=[e,{dataSrc:h,nodes:c,values:o,triggerRow:r.row(this.dom.target)}],this._emitEvent("row-reorder",u),this.c.editor&&(this.c.enabled=!1,this.c.editor.edit(c,!1,n.extend({submit:"changed"},this.c.formOptions)).multiSet(h,o).one("submitComplete",function(){y.c.enabled=!0}).submit()),this.c.update){for(t=0,s=e.length;t<s;t++)o=r.row(e[t].node).data(),p(o,e[t].newData),r.columns().every(function(){this.dataSrc()===h&&r.cell(e[t].node,this.index()).invalidate("data")});this._emitEvent("row-reordered",u);r.draw(!1)}},_shiftScroll:function(n){var o=this,t=this.s.scroll,f=!1,e=n.pageY-i.body.scrollTop,r,u;65>e?r=-5:e>t.windowHeight-65&&(r=5);null!==t.dtTop&&n.pageY<t.dtTop+65?u=-5:null!==t.dtTop&&n.pageY>t.dtTop+t.dtHeight-65&&(u=5);r||u?(t.windowVert=r,t.dtVert=u,f=!0):this.s.scrollInterval&&(clearInterval(this.s.scrollInterval),this.s.scrollInterval=null);!this.s.scrollInterval&&f&&(this.s.scrollInterval=setInterval(function(){if(t.windowVert&&(i.body.scrollTop=i.body.scrollTop+t.windowVert),t.dtVert){var n=o.dom.dtScroll[0];t.dtVert&&(n.scrollTop=n.scrollTop+t.dtVert)}},20))}});u.defaults={dataSrc:0,editor:null,enabled:!0,formOptions:{},selector:"td:first-child",snapX:!1,update:!0};e=n.fn.dataTable.Api;e.register("rowReorder()",function(){return this});e.register("rowReorder.enable()",function(n){return n===r&&(n=!0),this.iterator("table",function(t){t.rowreorder&&(t.rowreorder.c.enabled=n)})});e.register("rowReorder.disable()",function(){return this.iterator("table",function(n){n.rowreorder&&(n.rowreorder.c.enabled=!1)})});u.version="1.2.0";n.fn.dataTable.RowReorder=u;n.fn.DataTable.RowReorder=u;n(i).on("init.dt.dtr",function(t,i){if("dt"===t.namespace){var e=i.oInit.rowReorder,r=f.defaults.rowReorder;(e||r)&&(r=n.extend({},e,r),!1!==e&&new u(i,r))}});return u});